<html>
<!-- Head tag -->
<head>
  <meta charset="UTF-8">

  
  <title>
    隐马尔可夫模型 |
    blog
  </title>
  


  <meta name="description" content="">
  <meta name="author" content="张若淇">
  <meta property="og:title" content="隐马尔可夫模型" />
  <meta property="og:description" content="" />
  <meta property='og:site_name' content='blog' />
  <meta property="og:image" content="http://example.com/img/default.jpg" />
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:description" content="" />
  <meta name="twitter:title" content="隐马尔可夫模型" />

  <meta name="twitter:image" content="http://example.com/img/default.jpg" />

  <script src="https://www.amcharts.com/lib/4/core.js"></script>
  <script src="https://www.amcharts.com/lib/4/charts.js"></script>
  <script src="https://www.amcharts.com/lib/4/themes/animated.js"></script>

  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO"
    crossorigin="anonymous">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css" integrity="sha384-5sAR7xN1Nv6T6+dT2mhtzEpVJvfS3NScPQTrOxhwjIuvcA67KV2R5Jz6kr4abQsz"
    crossorigin="anonymous">
  
<link rel="stylesheet" href="/css/style.css">


<meta name="generator" content="Hexo 6.2.0"></head>

<body>
    <!-- Menu -->
    <nav id="navbar" class="navbar fixed-top navbar-expand-lg navbar-dark page-navbar gradient">
  <div class="container">
    <a class="navbar-brand logo" href="http://example.com">
      blog</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav"
      aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav mx-auto">
        <li class="nav-item item">
          
        <li class="nav-item item">
          <a class="nav-link" href="/">
            Home</a>
        </li>
        
        <li class="nav-item item">
          <a class="nav-link" href="/archives">
            🗂️Archives</a>
        </li>
        
        <li class="nav-item item">
          <a class="nav-link" target="_blank" rel="noopener" href="https://hexo.io/">
            Hexo</a>
        </li>
        
        </li>
      </ul>
    </div>
  </div>
</nav>

    <main class="page main-page">
        <div class="container blogPost">
    <div class="row">
        <div class="col-sm-9 px-md-5">
            <h2 class="blog-post-title">
                隐马尔可夫模型
            </h2>
            <p class="meta">
                <i class="far fa-clock"></i>
                2023-09-01 
            </p>
            <!-- Content -->
            <h1 id="隐马模型"><a href="#隐马模型" class="headerlink" title="隐马模型"></a>隐马模型</h1><p>隐马模型指的是：随机变量序列不服从马尔可夫模型，而是随机序列的隐藏状态服从马尔可夫模型。</p>
<p><img src="/2023/09/01/%E9%9A%90%E9%A9%AC%E5%B0%94%E5%8F%AF%E5%A4%AB%E6%A8%A1%E5%9E%8B/1.png" alt></p>
<p>其中随机变量s1,s2,s3,s4是一个马尔可夫序列。</p>
<h2 id="隐马模型可以解决的三个问题："><a href="#隐马模型可以解决的三个问题：" class="headerlink" title="隐马模型可以解决的三个问题："></a>隐马模型可以解决的三个问题：</h2><p>1：评估：给定隐马模型，评估当前序列的出现概率</p>
<p>2：解码：给定隐马模型及观测序列，求得隐藏状态序列</p>
<p>3：学习：给定观测序列，学的隐马模型。</p>
<h2 id="隐马模型的评估"><a href="#隐马模型的评估" class="headerlink" title="隐马模型的评估"></a>隐马模型的评估</h2><h3 id="评估方式1"><a href="#评估方式1" class="headerlink" title="评估方式1"></a>评估方式1</h3><p>枚举所有序列分布。费时</p>
<h3 id="评估方式2"><a href="#评估方式2" class="headerlink" title="评估方式2"></a>评估方式2</h3><h4 id="前向传播算法"><a href="#前向传播算法" class="headerlink" title="前向传播算法"></a>前向传播算法</h4><p>使用DP算法（动态规划）。马尔可夫模型作为序列模型很符合DP算法。我们使用dp算法计算出在最终时间步T下的状态分布。具体计算如下：</p>
<p><img src="/2023/09/01/%E9%9A%90%E9%A9%AC%E5%B0%94%E5%8F%AF%E5%A4%AB%E6%A8%A1%E5%9E%8B/2.png" alt></p>
<p>当t=1时，计算出状态S的分布并求出观测点n1的概率分布。</p>
<p><img src="/2023/09/01/%E9%9A%90%E9%A9%AC%E5%B0%94%E5%8F%AF%E5%A4%AB%E6%A8%A1%E5%9E%8B/3.png" alt></p>
<p>根据状态根据t=1时的分布，计算t=2时的隐状态St=2。计算n2的概率分布。</p>
<p>最终直至计算出序列的分布。</p>
<p>公式表示如下：</p>
<p><img src="/2023/09/01/%E9%9A%90%E9%A9%AC%E5%B0%94%E5%8F%AF%E5%A4%AB%E6%A8%A1%E5%9E%8B/4.png" alt></p>
<p>DP函数为在t时刻下，序列满足n1-nt，并且当前状态为Si的概率</p>
<p>后向传播算法与前向转播算法思路一致。</p>
<h2 id="隐马模型的解码"><a href="#隐马模型的解码" class="headerlink" title="隐马模型的解码"></a>隐马模型的解码</h2><p>解码指的是给定模型的观测序列，和隐马模型，推断出最大似然隐状态分布。使用Viterbi 算法求解</p>
<p><img src="/2023/09/01/%E9%9A%90%E9%A9%AC%E5%B0%94%E5%8F%AF%E5%A4%AB%E6%A8%A1%E5%9E%8B/5.webp" alt></p>
<p>画图理解隐马模型的解码问题</p>
<p><img src="/2023/09/01/%E9%9A%90%E9%A9%AC%E5%B0%94%E5%8F%AF%E5%A4%AB%E6%A8%A1%E5%9E%8B/6.png" alt></p>
<p>当观测序列只有一个o1时，要想让o1取得最大值，那应该选择s1= i 使得bi(o1)最大。bi（）指的是在i这个隐状态下的o=o1的概率分布。举一个天气的例子：</p>
<p>假设初始天气有阴晴两种状态分布为[0.5,0.5],西瓜甜与不甜的概率在阴天条件下为[0.3,0.7]，晴天则为[0.7,0.3],阴晴的移步转移矩阵为[[0.1,0.9][0.3,0.7]]这个转移矩阵指的是阴-&gt;阴的概率0.1，阴-&gt;晴的概率0.9，晴-&gt;阴的概率0.3，晴-&gt;晴的概率0.7。如果观测到的o1是西瓜不甜，那么很有可能S1应该是阴天。</p>
<p><img src="/2023/09/01/%E9%9A%90%E9%A9%AC%E5%B0%94%E5%8F%AF%E5%A4%AB%E6%A8%A1%E5%9E%8B/7.png" alt></p>
<p>但是如果第二天再去观测西瓜的状态，发现西瓜还是不甜的。那么s1-&gt;s2的序列最有可能是两天阴天吗？答案肯定是否定的。因为连续阴天-&gt;阴天的概率只有0.5*0.1！因此隐马模型的解码问题并非是寻找一个序列s1-&gt;s2-&gt;s3-&gt;s4-&gt;…-&gt;sn使o1-&gt;o2….-&gt;on最大，而是使得他们的联合分布p(s1..-&gt;sn,o1-&gt;on)最大。</p>
<p>按照这个思路，我们假设观测到西瓜的状态为（不甜，不甜，甜，不甜，甜）使用最大似然的方法预测过去五天的天气状况。</p>
<p>我们计算一个某一个隐状态下，观测序列为（不甜，不甜，甜，不甜，甜）概率。比如（阴，晴，晴，晴，阴）。他们的联合概率为$(0.5<em>0.7)</em>(0.9<em>0.3)</em>(0.7<em>0.7)</em>(0.7<em>0.3)</em>(0.3*0.3)$。按照这个进度我们只需要计算出序列的概率就可以找到最大似然情况：</p>
<p><img src="/2023/09/01/%E9%9A%90%E9%A9%AC%E5%B0%94%E5%8F%AF%E5%A4%AB%E6%A8%A1%E5%9E%8B/8.png" alt><br>这里面的s1指晴，s2指阴o1为甜o2为不甜。但是我们发现竟然有这么多情况当隐状态S的种类比较多时。计算的内容实在太多了。因此实际上要将这个问题视为最短路径问题，并使用维特比算法简化枚举的个数。</p>
<h3 id="维特比算法"><a href="#维特比算法" class="headerlink" title="维特比算法"></a>维特比算法</h3><p>维特比算法旨在求取最短路径。维特比算法认为，如果最短路径经过某个点，那么他一定也经过了一整个起始点到这个点的最短路径。因此从起始点到这个点的非最短路径是完全不可能是最短路径的一部分的，这些路径将作为非重要路径被舍弃。如图所示。</p>
<p><img src="/2023/09/01/%E9%9A%90%E9%A9%AC%E5%B0%94%E5%8F%AF%E5%A4%AB%E6%A8%A1%E5%9E%8B/9.png" alt><br><img src="/2023/09/01/%E9%9A%90%E9%A9%AC%E5%B0%94%E5%8F%AF%E5%A4%AB%E6%A8%A1%E5%9E%8B/10.png" alt></p>
<p>在第一步，我们可以假设最短路径经过点p1,1。也可以假设经过p1,2。所以三条基础路径都应该作为最短路径保留。在第二步种，首先假设如果最短路径经过p2,1。那么他一定经过起始点-&gt;p2,1的最短路径即s-&gt;p1,2-&gt;p2,1。而其他路径就作为非重要路径舍弃。这就是维特比算法。</p>
<h3 id="在隐马模型中使用维特比算法"><a href="#在隐马模型中使用维特比算法" class="headerlink" title="在隐马模型中使用维特比算法"></a>在隐马模型中使用维特比算法</h3><p>我们发现我们之前计算的公式$(0.5<em>0.7)</em>(0.9<em>0.3)</em>(0.7<em>0.7)</em>(0.7<em>0.3)</em>(0.3*0.3)$按照括号也是分五步的，括号内的内容为当前状态i到下一状态j的移步转移概率以及下一状态下得到观测值ot的概率bj(ot)。因此我们可以将每一步作为步长并对之前的路径剪枝。首先画出完整的路径图如下<br><img src="/2023/09/01/%E9%9A%90%E9%A9%AC%E5%B0%94%E5%8F%AF%E5%A4%AB%E6%A8%A1%E5%9E%8B/11.png" alt><br>剪枝之后的路径为<br><img src="/2023/09/01/%E9%9A%90%E9%A9%AC%E5%B0%94%E5%8F%AF%E5%A4%AB%E6%A8%A1%E5%9E%8B/12.png" alt></p>
<h2 id="隐马的学习"><a href="#隐马的学习" class="headerlink" title="隐马的学习"></a>隐马的学习</h2><p>隐马学习指的是给定一个观测序列，根据最大似然估计求含参模型中的参数值。就是说在上个问题中，我们假设了初始天气有阴晴两种状态分布为[0.5,0.5],西瓜甜与不甜的概率在阴天条件下为[0.3,0.7]，晴天则为[0.7,0.3],阴晴的移步转移矩阵为[[0.1,0.9][0.3,0.7]]这个转移矩阵指的是阴-&gt;阴的概率0.1，阴-&gt;晴的概率0.9，晴-&gt;阴的概率0.3，晴-&gt;晴的概率0.7，这些就是我们构建的隐马模型的参数。但是现在我们不知道矩阵中的数，但是我们已经观测到了这些观测序列（不甜，不甜，甜，不甜，甜），如何使用极大似然的方法，估计出上面的矩阵中的数据。我们可以发现西瓜的甜这一现象可能是来自晴天的分布，也可能是来自阴天的分布。因此可以将来自哪个天气状态作为一个隐变量，然后使用EM算法来求解。</p>

            <br />
            <p class="meta">
                
            </p>
        </div>

        <div class="col-sm-3">
             
<span><b> TL;DR</b></span>
<p>
	Yet another hexo theme.
</p>
<hr />


<span><b> TL;DR 2</b></span>
<p>
	No, not another one :/
</p>
<hr />

 

<span
	><a href="https://twitter.com/hexojs" target="_blank" rel="noopener"
		><b
			><i class="fab fa-twitter-square"></i>
			<i class="fas fa-at"></i>
			hexojs</b
		></a
	></span
>
<br />
<a class="twitter-timeline" data-height="800" data-dnt="true" data-chrome="nofooter transparent noheader noborders " target="_blank" rel="noopener" href="https://twitter.com/hexojs?ref_src=twsrc%5Etfw"></a>
<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>


        </div>
    </div>
</div>
<!-- Menu fade on scroll -->
<script>
    var isScrolling;
    var prevScrollpos = window.pageYOffset;
    window.addEventListener(
        'scroll',
        function(event) {
            window.clearTimeout(isScrolling);
            isScrolling = setTimeout(function() {
                var currentScrollPos = window.pageYOffset;
                if (prevScrollpos > currentScrollPos) {
                    $('#navbar').slideDown();
                } else {
                    $('#navbar').slideUp();
                }
                prevScrollpos = currentScrollPos;
            }, 66);
        },
        false
    );
</script>


<a class="float-left gradient btn paginationbtn" href="/2023/08/31/EM算法/"><i class="fas fa-chevron-left"></i></a>


<a class="float-right gradient btn paginationbtn" href="/2023/09/05/最大熵模型/"><i class="fas fa-chevron-right"></i></a>

    </main>
    <!-- Footer -->
    <footer class="page-footer">
  <div class="container">
    <div class="social-icons">
      
      <a href="https://hexo.io/" title="Hexo.io" target="_blank" rel="noopener" class="fas fa-home"></a>
      
      <a href="https://twitter.com/hexojs" title="@hexojs" target="_blank" rel="noopener" class="fab fa-twitter"></a>
      
      <a href="https://github.com/RandomAdversary/Gradient/issues" title="Report issue" target="_blank" rel="noopener" class="fas fa-bug"></a>
      
    </div>
  </div>
</footer>
    <!-- After footer scripts -->
    <script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
    crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
    crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
    crossorigin="anonymous"></script>
</body>

</html>